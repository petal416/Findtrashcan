{% extends 'base.html' %}
{% block title %}마이 페이지{% endblock %}

{% block content %}
<div class="box">
    <h2>리뷰 목록</h2>

    <section class="section">
        <div id="review-box" class="container">
        </div>
    </section>

</div>
<div class="box">
    <h2>즐겨찾기 목록</h2>
    <section class="section">
        <div id="favorite-box" class="container">
        </div>
    </section>
</div>
{% block script %}
<script>
    $(document).ready(function () {
        $("#link-mypage").addClass("is-hidden")
        $("#link-home").toggleClass("is-hidden")

        get_reviews("{{ user_info.username }}")
    })

    function add_review() {
        let stars = $("#select-rate option:selected").val()
        let review = $('#input-review').val()
        let today = new Date().toISOString()
        console.log(stars, review, today)

        $.ajax({
            type: 'POST',
            url: '/reviewing',
            data: {
                star_give: stars,
                review_give: review,
                date_give: today,
            },
            success: function (response) {
                alert(response['msg'])
                window.location.reload()
            }
        })
    }

    function time_to_str(date) {
        let today = new Date()
        let time = (today - date) / 1000 / 60  // 분

        if (time < 60) {
            return parseInt(time) + "분 전"
        }
        time = time / 60  // 시간
        if (time < 24) {
            return parseInt(time) + "시간 전"
        }
        time = time / 24
        if (time < 7) {
            return parseInt(time) + "일 전"
        }
        return `${date.getFullYear()}년 ${date.getMonth() + 1}월 ${date.getDate()}일`
    }

</script>
{% endblock %}
{% endblock %}