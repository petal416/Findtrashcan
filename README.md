# Findtrashcan
서울시 쓰레기 여기 버려!
* 외출시 쓰레기를 버려야 하는 상황이 생겼을 때 쓰레기통에 버릴 수 있도록 서울시의 가로휴지통 정보를 공유하는 플랫폼입니다.

## 1. 제작기간 & 팀원소개
* 2022년 8월 1일 ~ 2022년 8월 4일 (총4일)
* 4인 1조 팀 프로젝트 & 기능 구현
  - 전선향 : 로그인, 회원가입 페이지 제작, 회원가입 기능 구현, 회원가입시 ID 중복 확인 및 정규표현식을 활용한 PW 패턴 매칭 기능 구현, 프로필 수정 기능 구현, jwt토큰을 활용한 로그인/로그아웃 기능 구현, hash함수를 통한 PW 암호화 기능 추가, 회원 DB 생성, 타이틀 로고 제작
  - 신진경 : 메인 페이지 및 상세 페이지 제작, 네이버 지도 생성 및 출력(네이버 API), 마커 생성 및 마커 이미지 변경, 마커에 이벤트를 추가하여 이벤트함수 구현, infowindow 생성 및 여닫기, pandas모듈을 활용한 Excel데이터 읽기, 서울시 쓰레기통 DB 생성
  - 김도희 : 로그인, 회원가입 페이지 제작, 회원가입 기능 구현, 회원가입시 ID 중복 확인 및 정규표현식을 활용한 PW 패턴 매칭 기능 구현, 프로필 수정 기능 구현, jwt토큰을 활용한 로그인/로그아웃 기능 구현, hash함수를 통한 PW 암호화 기능 추가
  - 문지웅 : jinja2 템플릿을 활용한 템플릿 구성(base.html, myjs.js, mystyle.css), 상세 페이지 제작, 리뷰 작성 및 조회 기능 구현, 리뷰 DB 생성, meta data 생성(ex. og:title)

## 2. 사용 API
* Back-end
    - Flask (python frame work)
    - MongoDB
    - pyjwt
    - pandas
    - hashlib
* Front-end
    - bulma
    - fontawesome
    - google-font
    - JQuery
    - AJAX
* Deploy
    - AWS EC2
    
## 3. 핵심기능
 * 회원가입 및 로그인
   - JWT를 이용하여 token을 생성해서 로그인/로그아웃 기능을 구현하였습니다.
   - MongoDB에 회원정보를 저장 및 조회하여 회원가입을 구현하였습니다.
   - 회원가입시 DB를 조회하여 아이디가 중복되었는지 확인합니다.
   - 정규표현식을 활용한 아이디/비밀번호 패턴 매칭 기능을 구현하였습니다.
 
 * 주소 검색
   - DB에 쓰레기통 Data를 조회하여 쓰레기통이 있는 자치구만 추려서 검색 목록에 추가합니다.
   - 검색을 원하는 구를 선택하고 검색 버튼을 누를시 해당 구와 같은 구를 가진 데이터를 모두 조회하여 지도에 마커를 생성합니다.
   - 다른 구를 검색할 경우, 이미 찍혀있떤 마커를 모두 제거하고 다시 마커를 생성하여 지도에 생성합니다.
   - 마커에 마우스를 올렸다/내려놓을때마다 마커의 아이콘을 변경합니다(마우스 이벤트).
   - 마커를 클릭할 시, 해당 마커의 좌표를 infoWindow에 넣어 출력합니다.
   - infoWindow의 내용을 클릭할 시, 하이퍼링크를 통해 상세 페이지로 이동합니다.
   
 * 상세페이지 리뷰 기능
   - 상세페이지에서는 특정 주소의 쓰레기통만 지도에 출력하여 보여줍니다.
   - 해당 페이지에서는 특정 주소의 쓰레기통에 대한 리뷰를 볼 수 있습니다.
   - 리뷰 목록은 페이지가 로딩될 때, AJAX 통해 서버에 요청하여 리뷰 DB에 저장된 내용을 받아옵니다.
   - 로그인이 되어있을 시, 해당 쓰레기통에 대한 리뷰를 남길 수 있습니다.
   - 쓰레기통에 대한 리뷰를 남기면 AJAX를 통해 서버에 요청하여 리뷰 DB에 데이터를 추가합니다.
   - 각 리뷰는 쓰레기통의 주소와 작성자의 ID를 통해 식별합니다.
   
 * 구글지도 기능
   - Google cloud platform에서 지도API와 좌표API를 활용하여 상세페이지에 지도 기능을 구현하였습니다.


## 4. 실행화면
<유튜브 링크>
## 5.이슈정리
* Q1. 쓰레기통 리스트페이지에서 쓰레기통 상세페이지로 이동을 위해서는 각 쓰레기통 id를 부여 해야하는데 어떤식으로 각 쓰레기통을 규명할 id를 만들어 낼 수 있을까?  
   - A1. 쓰레기통 대한 DB를 구성할때 ['쓰레기통 주소', '좌표', 'id']를 만들어서 넣어주면 각 쓰레기통에 대한 id를 부여하는 것이 될거라고 판단했습니다.  
         따라서 id는 파이썬에서 for문을 이용하여 1부터 N까지 DB에 넣는 순서대로 id를 부여해 주었습니다.  
         그렇게 쓰레기통리스트를 누르면 href = "현재url/쓰레기통id "로 이동하도록하여 각 쓰레기통마다의 id로 상세페이지를 부여해주었습니다.(진경님 수정)
         
* Q2. 쓰레기통에 대한 정보(데이터)를 모아둔 사이트를 크롤링하여 DB에 데이터를 쌓아야했는데, 사이트 혹은 구글지도 등에서 제공하는 쓰레기통정보는 사용하기에 너무 불편하게 되어있었던 문제를 어떻게 해결할 것인가?
   - A2. 쓰레기통에 대한 정보를 제공해주는 공공 데이터 포털 사이트(API제공 사이트)를 발견하여 여기서 쓰레기통 주소, 위도, 경도 데이터를 DB에 쌓을 수 있었습니다.

* Q3. 카카오지도나 구글지도를 크롤링하여서 지도정보를 사용하고 싶은데, 셀레니움이라는 파이썬 라이브러리까지 사용해야 하여 상당히 불편하게 되어있어서 어떻게 하면 지도정도를 가져올 수 있을까?
   - A3. 구글이 제공하는 googlemap API를 사용해보기로 하였습니다. 처음 가입하면 300달러를 지원해주어서 이번 단기 프로젝트 하는동안에는 충분하다고 판단되어 구글이 제공하는 map UI와 X,Y좌표를 한국주소로 변환해주는 API를 활용하였습니다.
         프로젝트 하는동안에는 충분하다고 판단되어 구글이 제공하는 map UI와 X,Y좌표를 한국주소로 변환해주는 API를 활용하였습니다.
         (진경님 수정)

* Q4.  로그인 페이지에서 ID, PW를 클라이언트 <-> 서버 매칭하여 토큰발행 과정에서 오류 발생.
   - A4. 개발 시 localhost 환경에서는 decode가 이미 되어있어서 필요없는코드였지만, 배포 시 리눅스 환경에서는 .decode('utf-8')을 포함시켜서 배포하여 해결하였습니다.  
         ```python
         token = jwt.encode(payload, SECRET_KEY, algorithm='HS256').decode('utf-8')
         ```
