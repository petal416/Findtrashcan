# Findtrashcan
서울시 쓰레기 여기 버려!
* 외출시 쓰레기를 버려야 하는 상황이 생겼을 때 쓰레기통에 버릴 수 있도록 서울시의 가로휴지통 정보를 공유하는 플랫폼입니다.

## 1. 제작기간 & 팀원소개
* 2022년 8월 1일 ~ 2022년 8월 4일 (총4일)
* 4인 1조 팀 프로젝트 & 기능 구현
  - 전선향 : 로그인, 회원가입 페이지 제작, 회원가입 기능 구현, 회원가입시 ID 중복 확인 및 정규표현식을 활용한 PW 패턴 매칭 기능 구현, 프로필 수정 기능 구현, jwt토큰을 활용한 로그인/로그아웃 기능 구현, hash함수를 통한 PW 암호화 기능 추가, 회원 DB 생성, 타이틀 로고 제작
  - 신진경 : 메인 페이지 및 상세 페이지 제작, 네이버 지도 생성 및 출력(네이버 API), 마커 생성 및 마커 이미지 변경, 마커에 이벤트를 추가하여 이벤트함수 구현, infowindow 생성 및 여닫기, pandas모듈을 활용한 Excel데이터 읽기, 서울시 쓰레기통 DB 생성
  - 김도희 : 로그인, 회원가입 페이지 제작, 회원가입 기능 구현, 회원가입시 ID 중복 확인 및 정규표현식을 활용한 PW 패턴 매칭 기능 구현, 프로필 수정 기능 구현, jwt토큰을 활용한 로그인/로그아웃 기능 구현, hash함수를 통한 PW 암호화 기능 추가
  - 문지웅 : jinja2 템플릿을 활용한 템플릿 구성(base.html, myjs.js, mystyle.css), 상세 페이지 제작, 리뷰 작성 및 조회 기능 구현, 리뷰 DB 생성, meta data 생성(ex. og:title)

## 2. 사용 API
* Back-end
    - Flask (python frame work)
    - MongoDB
    - pyjwt
    - pandas
    - hashlib
* Front-end
    - bulma
    - fontawesome
    - google-font
    - JQuery
    - AJAX
* Deploy
    - AWS EC2
    
## 3. 핵심기능
 * 회원가입 및 로그인
   - JWT를 이용하여 token을 생성해서 로그인/로그아웃 기능을 구현하였습니다.
   - MongoDB에 회원정보를 저장 및 조회하여 회원가입을 구현하였습니다.
   - 회원가입시 DB를 조회하여 아이디가 중복되었는지 확인합니다.
   - 정규표현식을 활용한 아이디/비밀번호 패턴 매칭 기능을 구현하였습니다.

 * 회원정보 수정
   - 마이페이지로 이동 시, 현재 토큰을 검사하여 해당 페이지가 현재 접속한 유저의 페이지인지를 확인합니다.
   - 해당 유저의 페이지일 경우, 회원정보 수정 버튼이 나타나고 그렇지 않을 경우, 회원정보 수정 버튼이 나타나지 않습니다.
   - 회원정보 수정은 닉네임, 사진, 자기소개 등을 수정할 수 있으며 AJAX요청을 통해 DB에서 업데이트합니다.
 
 * 주소 검색
   - DB에 쓰레기통 Data를 조회하여 쓰레기통이 있는 자치구만 추려서 검색 목록에 추가합니다.
   - 검색을 원하는 구를 선택하고 검색 버튼을 누를시 해당 구와 같은 구를 가진 데이터를 모두 조회하여 지도에 마커를 생성합니다.
   - 다른 구를 검색할 경우, 이미 찍혀있떤 마커를 모두 제거하고 다시 마커를 생성하여 지도에 생성합니다.
   - 마커에 마우스를 올렸다/내려놓을때마다 마커의 아이콘을 변경합니다(마우스 이벤트).
   - 마커를 클릭할 시, 해당 마커의 좌표를 infoWindow에 넣어 출력합니다.
   - infoWindow의 내용을 클릭할 시, 하이퍼링크를 통해 상세 페이지로 이동합니다.
   
 * 상세페이지 리뷰 기능
   - 상세페이지에서는 특정 주소의 쓰레기통만 지도에 출력하여 보여줍니다.
   - 해당 페이지에서는 특정 주소의 쓰레기통에 대한 리뷰를 볼 수 있습니다.
   - 리뷰 목록은 페이지가 로딩될 때, AJAX 통해 서버에 요청하여 리뷰 DB에 저장된 내용을 받아옵니다.
   - 로그인이 되어있을 시, 해당 쓰레기통에 대한 리뷰를 남길 수 있습니다.
   - 쓰레기통에 대한 리뷰를 남기면 AJAX를 통해 서버에 요청하여 리뷰 DB에 데이터를 추가합니다.
   - 각 리뷰는 쓰레기통의 주소와 작성자의 ID를 통해 식별합니다.
   
 * 네이버 지도, 마커 및 infowindow 기능
   - Naver cloud platform에서 발급받은 Key를 통해 헤더를 구성, 요청하여 사용하였습니다.
   - 네이버 지도를 원하는 형태(지도 크기, 지도 위치, 확대율 등)로 생성하여 출력합니다.
   - 네이버 Geocoding을 활용하여 주소를 통해 위도, 경도를 추출하여 해당 위치에 마커를 생성합니다.
   - infowindow는 마커에 이벤트함수를 추가하여 마우스 클릭시 해당 마커의 좌표를 받아서 해당 위치에 infowindow를 띄웁니다.


## 4. 실행화면
<유튜브 링크>
## 5.이슈정리
* Q1. Excel에 있는 데이터를 원하는 형태로 읽어와서 DB에 넣고 싶은데 어떻게 해결해야 될것인가?
   - A1. python 라이브러리중 pandas 모듈을 활용하여 문제를 해결하였습니다. pandas모듈의 read_excel()함수를 통해 엑셀파일을 읽어올 수 있으며,
         매개변수로 각종 옵션을 추가하여 원하는 형태로 가공하여 엑셀 파일을 읽어올 수 있습니다. 예를 들어, 특정 열의 데이터만 읽어온다든가, 
         열에 이름을 붙여주거나, 읽어올 행의 수도 지정해줄 수 있습니다. pandas 모듈로 읽어온 data를 numpy형태로 변환하면 리스트처럼 index를 통해
         원하는 데이터에 접근할 수 있고, 이를 통해 원하는 형태로 가공하여 DB에 손쉽게 저장할 수 있습니다.
         
* Q2. 네이버 API를 활용하여 지도를 띄우고 활용해야 하는데 어떻게 해결해야 될것인가?
   - A2. naver cloud platform에 가입하고 사용하고싶은 API를 신청한 후, 개인 Key를 발급받아서 네이버 API에 요청을 할 때 header에 개인 Key를
         를 같이 보내 인증 받고 원하는 기능을 활용할 수 있습니다. 사용법 같은 경우 naver cloud platform에서 해당 API 기능을 검색하거나 구글링 및
         강의를 보면서 사용법을 익힐 수 있습니다.

* Q3. 주소(ex.00구 00로 00 앞) 문자열을 자르고 붙이고 해서 원하는 형태로 가공하고 싶은데 어떻게 해야될까요?
   - A3. python 자체 내장 함수(ex. strip(), split())를 활용하여 문제를 해결했습니다. 문자열을 특정 구분자를 기준으로 자르거나, 좌우에 공백 또는 특정
         문자를 삭제하거나 등등 원하는 형태로 가공하여 원하는 Data를 추가하거나 또는 얻어올 수 있었습니다.

* Q4.  로그인 페이지에서 ID, PW를 클라이언트 <-> 서버 매칭하여 토큰발행 과정에서 오류 발생.
   - A4. 개발 시 localhost 환경에서는 decode가 이미 되어있어서 필요없는코드였지만, 배포 시 리눅스 환경에서는 .decode('utf-8')을 포함시켜서 배포하여 해결하였습니다.  
         ```python
         token = jwt.encode(payload, SECRET_KEY, algorithm='HS256').decode('utf-8')
         ```
